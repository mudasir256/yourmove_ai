import { Fragment, useState } from "react";
import { Dialog, Transition } from "@headlessui/react";
import {
  Bars3Icon,
  ChevronRightIcon,
  XMarkIcon,
} from "@heroicons/react/24/outline";
import { Link, useNavigate } from "react-router-dom";
import { useAuthStore } from "../../stores/auth";
import { AuthActionType } from "../../constants/auth";
import { auth } from "../../firebase";
import { signOut } from "firebase/auth";
import toast from "react-hot-toast";
import { FeedbackModal } from "../modals/FeedbackModal";
import { Logo } from "../Logo";

const APP_STORE_URL = "https://apps.apple.com/us/app/yourmove-ai/id6444244023";

function classNames(...classes: any) {
  return classes.filter(Boolean).join(" ");
}

export const SideNav = () => {
  const [sidebarOpen, setSidebarOpen] = useState(false);
  const navigate = useNavigate();
  const { setAuthModalIsOpen, setAuthActionType, isSubscribed } =
    useAuthStore();
  const user = auth.currentUser;
  const [feedbackModalOpen, setFeedbackModalOpen] = useState(false);

  return (
    <>
      <FeedbackModal open={feedbackModalOpen} setOpen={setFeedbackModalOpen} />
      <div>
        <Transition.Root show={sidebarOpen} as={Fragment}>
          <Dialog as="div" className="relative z-50" onClose={setSidebarOpen}>
            <Transition.Child
              as={Fragment}
              enter="transition-opacity ease-linear duration-300"
              enterFrom="opacity-0"
              enterTo="opacity-100"
              leave="transition-opacity ease-linear duration-300"
              leaveFrom="opacity-100"
              leaveTo="opacity-0"
            >
              <div className="fixed inset-0 bg-gray-900/80" />
            </Transition.Child>

            <div className="fixed inset-0 flex">
              <Transition.Child
                as={Fragment}
                enter="transition ease-in-out duration-300 transform"
                enterFrom="-translate-x-full"
                enterTo="translate-x-0"
                leave="transition ease-in-out duration-300 transform"
                leaveFrom="translate-x-0"
                leaveTo="-translate-x-full"
              >
                <Dialog.Panel className="relative mr-16 flex w-full max-w-xs flex-1">
                  <Transition.Child
                    as={Fragment}
                    enter="ease-in-out duration-300"
                    enterFrom="opacity-0"
                    enterTo="opacity-100"
                    leave="ease-in-out duration-300"
                    leaveFrom="opacity-100"
                    leaveTo="opacity-0"
                  >
                    <div className="absolute left-full top-0 flex w-16 justify-center pt-5">
                      <button
                        type="button"
                        className="-m-2.5 p-2.5"
                        onClick={() => setSidebarOpen(false)}
                      >
                        <span className="sr-only">Close sidebar</span>
                        <XMarkIcon
                          className="h-6 w-6 text-white"
                          aria-hidden="true"
                        />
                      </button>
                    </div>
                  </Transition.Child>
                  {/* Sidebar component, swap this element with another sidebar if you like */}
                  <div className="flex grow flex-col gap-y-5 overflow-y-auto bg-white px-6 pb-4">
                    <div className="flex h-16 shrink-0 items-center">
                      <Logo />
                      {isSubscribed && (
                        <div className="bg-brand-primary text-white text-sm px-1.5 py-0.5 ml-2 rounded-md">
                          Premium
                        </div>
                      )}
                    </div>
                    {!isSubscribed && (
                      <div
                        onClick={() => {
                          setSidebarOpen(false);
                          navigate("/premium");
                        }}
                        className="-mx-6 -mt-5 hover:cursor-pointer"
                        style={{ backgroundColor: "#270006" }}
                      >
                        <svg
                          width="311"
                          height="72"
                          viewBox="0 0 311 72"
                          fill="none"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <g clip-path="url(#clip0_1295_6150)">
                            <rect width="320" height="72" fill="#270006" />
                            <circle
                              cx="65.5"
                              cy="142.5"
                              r="153.5"
                              fill="#BA1F33"
                            />
                            <path
                              d="M22.0057 19.3636V31H19.5455V21.6989H19.4773L16.8125 23.3693V21.1875L19.6932 19.3636H22.0057ZM29.3338 31.2557C28.3565 31.2519 27.5156 31.0114 26.8111 30.5341C26.1103 30.0568 25.5705 29.3655 25.1918 28.4602C24.8168 27.5549 24.6312 26.4659 24.6349 25.1932C24.6349 23.9242 24.8224 22.8428 25.1974 21.9489C25.5762 21.0549 26.116 20.375 26.8168 19.9091C27.5213 19.4394 28.3603 19.2045 29.3338 19.2045C30.3073 19.2045 31.1444 19.4394 31.8452 19.9091C32.5497 20.3788 33.0914 21.0606 33.4702 21.9545C33.849 22.8447 34.0365 23.9242 34.0327 25.1932C34.0327 26.4697 33.8433 27.5606 33.4645 28.4659C33.0895 29.3712 32.5516 30.0625 31.8509 30.5398C31.1501 31.017 30.3111 31.2557 29.3338 31.2557ZM29.3338 29.2159C30.0005 29.2159 30.5327 28.8807 30.9304 28.2102C31.3281 27.5398 31.5251 26.5341 31.5213 25.1932C31.5213 24.3106 31.4304 23.5758 31.2486 22.9886C31.0705 22.4015 30.8168 21.9602 30.4872 21.6648C30.1615 21.3693 29.777 21.2216 29.3338 21.2216C28.6709 21.2216 28.1406 21.553 27.7429 22.2159C27.3452 22.8788 27.1444 23.8712 27.1406 25.1932C27.1406 26.0871 27.2296 26.8333 27.4077 27.4318C27.5895 28.0265 27.8452 28.4735 28.1747 28.7727C28.5043 29.0682 28.8906 29.2159 29.3338 29.2159ZM37.8324 22.2727L39.4347 25.3239L41.0767 22.2727H43.5597L41.0312 26.6364L43.6278 31H41.1562L39.4347 27.983L37.7415 31H35.2415L37.8324 26.6364L35.3324 22.2727H37.8324ZM50.1946 34.2727C49.8878 34.2727 49.5999 34.2481 49.331 34.1989C49.0658 34.1534 48.8461 34.0947 48.6719 34.0227L49.2173 32.2159C49.5014 32.303 49.7571 32.3504 49.9844 32.358C50.2154 32.3655 50.4143 32.3125 50.581 32.1989C50.7514 32.0852 50.8897 31.892 50.9957 31.6193L51.1378 31.25L48.0071 22.2727H50.5526L52.3594 28.6818H52.4503L54.2741 22.2727H56.8366L53.4446 31.9432C53.2817 32.4129 53.0601 32.822 52.7798 33.1705C52.5033 33.5227 52.1529 33.7936 51.7287 33.983C51.3045 34.1761 50.7931 34.2727 50.1946 34.2727ZM61.7372 31.1705C60.8546 31.1705 60.0914 30.983 59.4474 30.608C58.8073 30.2292 58.313 29.7027 57.9645 29.0284C57.616 28.3504 57.4418 27.5644 57.4418 26.6705C57.4418 25.7689 57.616 24.9811 57.9645 24.3068C58.313 23.6288 58.8073 23.1023 59.4474 22.7273C60.0914 22.3485 60.8546 22.1591 61.7372 22.1591C62.6198 22.1591 63.3812 22.3485 64.0213 22.7273C64.6652 23.1023 65.1615 23.6288 65.5099 24.3068C65.8584 24.9811 66.0327 25.7689 66.0327 26.6705C66.0327 27.5644 65.8584 28.3504 65.5099 29.0284C65.1615 29.7027 64.6652 30.2292 64.0213 30.608C63.3812 30.983 62.6198 31.1705 61.7372 31.1705ZM61.7486 29.2955C62.1501 29.2955 62.4853 29.1818 62.7543 28.9545C63.0232 28.7235 63.2259 28.4091 63.3622 28.0114C63.5024 27.6136 63.5724 27.161 63.5724 26.6534C63.5724 26.1458 63.5024 25.6932 63.3622 25.2955C63.2259 24.8977 63.0232 24.5833 62.7543 24.3523C62.4853 24.1212 62.1501 24.0057 61.7486 24.0057C61.3433 24.0057 61.0024 24.1212 60.7259 24.3523C60.4531 24.5833 60.2467 24.8977 60.1065 25.2955C59.9702 25.6932 59.902 26.1458 59.902 26.6534C59.902 27.161 59.9702 27.6136 60.1065 28.0114C60.2467 28.4091 60.4531 28.7235 60.7259 28.9545C61.0024 29.1818 61.3433 29.2955 61.7486 29.2955ZM73.2031 27.2841V22.2727H75.6236V31H73.2997V29.4148H73.2088C73.0118 29.9261 72.6842 30.3371 72.2259 30.6477C71.7713 30.9583 71.2164 31.1136 70.5611 31.1136C69.9777 31.1136 69.4645 30.9811 69.0213 30.7159C68.5781 30.4508 68.2315 30.0739 67.9815 29.5852C67.7353 29.0966 67.6103 28.5114 67.6065 27.8295V22.2727H70.027V27.3977C70.0308 27.9129 70.169 28.3201 70.4418 28.6193C70.7145 28.9186 71.08 29.0682 71.5384 29.0682C71.83 29.0682 72.1027 29.0019 72.3565 28.8693C72.6103 28.733 72.8149 28.5322 72.9702 28.267C73.1293 28.0019 73.2069 27.6742 73.2031 27.2841ZM77.5597 31V22.2727H79.9062V23.7955H79.9972C80.1563 23.2538 80.4233 22.8447 80.7983 22.5682C81.1733 22.2879 81.6051 22.1477 82.0938 22.1477C82.215 22.1477 82.3456 22.1553 82.4858 22.1705C82.6259 22.1856 82.7491 22.2064 82.8551 22.233V24.3807C82.7415 24.3466 82.5843 24.3163 82.3835 24.2898C82.1828 24.2633 81.9991 24.25 81.8324 24.25C81.4763 24.25 81.1581 24.3277 80.8778 24.483C80.6013 24.6345 80.3816 24.8466 80.2188 25.1193C80.0597 25.392 79.9801 25.7064 79.9801 26.0625V31H77.5597ZM91.0256 31.142C90.3627 31.142 89.7623 30.9716 89.2244 30.6307C88.6903 30.286 88.2661 29.7803 87.9517 29.1136C87.6411 28.4432 87.4858 27.6212 87.4858 26.6477C87.4858 25.6477 87.6468 24.8163 87.9688 24.1534C88.2907 23.4867 88.7188 22.9886 89.2528 22.6591C89.7907 22.3258 90.3797 22.1591 91.0199 22.1591C91.5085 22.1591 91.9157 22.2424 92.2415 22.4091C92.571 22.572 92.8362 22.7765 93.0369 23.0227C93.2415 23.2652 93.3968 23.5038 93.5028 23.7386H93.5767V19.3636H95.9915V31H93.6051V29.6023H93.5028C93.3892 29.8447 93.2282 30.0852 93.0199 30.3239C92.8153 30.5587 92.5483 30.7538 92.2188 30.9091C91.893 31.0644 91.4953 31.142 91.0256 31.142ZM91.7926 29.2159C92.1828 29.2159 92.5123 29.1098 92.7812 28.8977C93.054 28.6818 93.2623 28.3807 93.4062 27.9943C93.554 27.608 93.6278 27.1553 93.6278 26.6364C93.6278 26.1174 93.5559 25.6667 93.4119 25.2841C93.268 24.9015 93.0597 24.6061 92.7869 24.3977C92.5142 24.1894 92.1828 24.0852 91.7926 24.0852C91.3949 24.0852 91.0597 24.1932 90.7869 24.4091C90.5142 24.625 90.3078 24.9242 90.1676 25.3068C90.0275 25.6894 89.9574 26.1326 89.9574 26.6364C89.9574 27.1439 90.0275 27.5928 90.1676 27.983C90.3116 28.3693 90.518 28.6723 90.7869 28.892C91.0597 29.108 91.3949 29.2159 91.7926 29.2159ZM100.47 31.1648C99.9134 31.1648 99.4171 31.0682 98.9815 30.875C98.5459 30.678 98.2012 30.3883 97.9474 30.0057C97.6974 29.6193 97.5724 29.1383 97.5724 28.5625C97.5724 28.0777 97.6615 27.6705 97.8395 27.3409C98.0175 27.0114 98.2599 26.7462 98.5668 26.5455C98.8736 26.3447 99.2221 26.1932 99.6122 26.0909C100.006 25.9886 100.419 25.9167 100.851 25.875C101.358 25.822 101.768 25.7727 102.078 25.7273C102.389 25.678 102.614 25.6061 102.754 25.5114C102.894 25.4167 102.964 25.2765 102.964 25.0909V25.0568C102.964 24.697 102.851 24.4186 102.624 24.2216C102.4 24.0246 102.082 23.9261 101.669 23.9261C101.233 23.9261 100.887 24.0227 100.629 24.2159C100.372 24.4053 100.201 24.6439 100.118 24.9318L97.8793 24.75C97.9929 24.2197 98.2164 23.7614 98.5497 23.375C98.883 22.9848 99.313 22.6856 99.8395 22.4773C100.37 22.2652 100.983 22.1591 101.68 22.1591C102.165 22.1591 102.629 22.2159 103.072 22.3295C103.519 22.4432 103.915 22.6193 104.26 22.858C104.608 23.0966 104.883 23.4034 105.084 23.7784C105.285 24.1496 105.385 24.5947 105.385 25.1136V31H103.089V29.7898H103.021C102.881 30.0625 102.694 30.303 102.459 30.5114C102.224 30.7159 101.942 30.8769 101.612 30.9943C101.283 31.108 100.902 31.1648 100.47 31.1648ZM101.163 29.4943C101.519 29.4943 101.834 29.4242 102.107 29.2841C102.379 29.1402 102.593 28.947 102.749 28.7045C102.904 28.4621 102.982 28.1875 102.982 27.8807V26.9545C102.906 27.0038 102.802 27.0492 102.669 27.0909C102.54 27.1288 102.394 27.1648 102.232 27.1989C102.069 27.2292 101.906 27.2576 101.743 27.2841C101.58 27.3068 101.432 27.3277 101.3 27.3466C101.016 27.3883 100.768 27.4545 100.555 27.5455C100.343 27.6364 100.179 27.7595 100.061 27.9148C99.9437 28.0663 99.8849 28.2557 99.8849 28.483C99.8849 28.8125 100.004 29.0644 100.243 29.2386C100.485 29.4091 100.792 29.4943 101.163 29.4943ZM111.905 22.2727V24.0909H106.649V22.2727H111.905ZM107.842 20.1818H110.263V28.3182C110.263 28.5417 110.297 28.7159 110.365 28.8409C110.433 28.9621 110.528 29.0473 110.649 29.0966C110.774 29.1458 110.918 29.1705 111.081 29.1705C111.195 29.1705 111.308 29.161 111.422 29.142C111.536 29.1193 111.623 29.1023 111.683 29.0909L112.064 30.892C111.943 30.9299 111.772 30.9735 111.553 31.0227C111.333 31.0758 111.066 31.108 110.751 31.1193C110.168 31.142 109.657 31.0644 109.217 30.8864C108.782 30.7083 108.443 30.4318 108.2 30.0568C107.958 29.6818 107.839 29.2083 107.842 28.6364V20.1818ZM117.365 31.1705C116.467 31.1705 115.695 30.9886 115.047 30.625C114.403 30.2576 113.907 29.7386 113.558 29.0682C113.21 28.3939 113.036 27.5966 113.036 26.6761C113.036 25.7784 113.21 24.9905 113.558 24.3125C113.907 23.6345 114.397 23.1061 115.03 22.7273C115.666 22.3485 116.412 22.1591 117.268 22.1591C117.844 22.1591 118.38 22.2519 118.876 22.4375C119.376 22.6193 119.812 22.8939 120.183 23.2614C120.558 23.6288 120.85 24.0909 121.058 24.6477C121.267 25.2008 121.371 25.8485 121.371 26.5909V27.2557H114.001V25.7557H119.092C119.092 25.4072 119.017 25.0985 118.865 24.8295C118.714 24.5606 118.503 24.3504 118.234 24.1989C117.969 24.0436 117.661 23.9659 117.308 23.9659C116.941 23.9659 116.615 24.0511 116.331 24.2216C116.051 24.3883 115.831 24.6136 115.672 24.8977C115.513 25.178 115.431 25.4905 115.428 25.8352V27.2614C115.428 27.6932 115.507 28.0663 115.666 28.3807C115.829 28.6951 116.058 28.9375 116.354 29.108C116.649 29.2784 117 29.3636 117.405 29.3636C117.674 29.3636 117.92 29.3258 118.143 29.25C118.367 29.1742 118.558 29.0606 118.717 28.9091C118.876 28.7576 118.998 28.572 119.081 28.3523L121.32 28.5C121.206 29.0379 120.973 29.5076 120.621 29.9091C120.272 30.3068 119.821 30.6174 119.268 30.8409C118.719 31.0606 118.085 31.1705 117.365 31.1705ZM130.212 24.7614L127.996 24.8977C127.958 24.7083 127.876 24.5379 127.751 24.3864C127.626 24.2311 127.462 24.108 127.257 24.017C127.056 23.9223 126.816 23.875 126.536 23.875C126.161 23.875 125.844 23.9545 125.587 24.1136C125.329 24.2689 125.2 24.4773 125.2 24.7386C125.2 24.947 125.284 25.1231 125.45 25.267C125.617 25.411 125.903 25.5265 126.308 25.6136L127.888 25.9318C128.736 26.1061 129.369 26.3864 129.786 26.7727C130.202 27.1591 130.411 27.6667 130.411 28.2955C130.411 28.8674 130.242 29.3693 129.905 29.8011C129.571 30.233 129.113 30.5701 128.53 30.8125C127.95 31.0511 127.282 31.1705 126.524 31.1705C125.369 31.1705 124.448 30.9299 123.763 30.4489C123.081 29.964 122.681 29.3049 122.564 28.4716L124.945 28.3466C125.017 28.6989 125.191 28.9678 125.467 29.1534C125.744 29.3352 126.098 29.4261 126.53 29.4261C126.954 29.4261 127.295 29.3447 127.553 29.1818C127.814 29.0152 127.946 28.8011 127.95 28.5398C127.946 28.3201 127.854 28.1402 127.672 28C127.49 27.8561 127.21 27.7462 126.831 27.6705L125.32 27.3693C124.467 27.1989 123.833 26.9034 123.416 26.483C123.003 26.0625 122.797 25.5265 122.797 24.875C122.797 24.3144 122.948 23.8314 123.251 23.4261C123.558 23.0208 123.988 22.7083 124.541 22.4886C125.098 22.2689 125.75 22.1591 126.496 22.1591C127.598 22.1591 128.465 22.392 129.098 22.858C129.734 23.3239 130.106 23.9583 130.212 24.7614ZM137.359 31L134.984 22.2727H137.433L138.786 28.1364H138.865L140.274 22.2727H142.678L144.109 28.1023H144.183L145.513 22.2727H147.956L145.587 31H143.024L141.524 25.5114H141.416L139.916 31H137.359ZM149.247 31V22.2727H151.668V31H149.247ZM150.463 21.1477C150.103 21.1477 149.795 21.0284 149.537 20.7898C149.283 20.5473 149.156 20.2576 149.156 19.9205C149.156 19.5871 149.283 19.3011 149.537 19.0625C149.795 18.8201 150.103 18.6989 150.463 18.6989C150.823 18.6989 151.13 18.8201 151.384 19.0625C151.641 19.3011 151.77 19.5871 151.77 19.9205C151.77 20.2576 151.641 20.5473 151.384 20.7898C151.13 21.0284 150.823 21.1477 150.463 21.1477ZM158.249 22.2727V24.0909H152.993V22.2727H158.249ZM154.186 20.1818H156.607V28.3182C156.607 28.5417 156.641 28.7159 156.709 28.8409C156.777 28.9621 156.872 29.0473 156.993 29.0966C157.118 29.1458 157.262 29.1705 157.425 29.1705C157.538 29.1705 157.652 29.161 157.766 29.142C157.879 29.1193 157.966 29.1023 158.027 29.0909L158.408 30.892C158.286 30.9299 158.116 30.9735 157.896 31.0227C157.677 31.0758 157.41 31.108 157.095 31.1193C156.512 31.142 156 31.0644 155.561 30.8864C155.125 30.7083 154.786 30.4318 154.544 30.0568C154.302 29.6818 154.182 29.2083 154.186 28.6364V20.1818ZM162.433 25.9545V31H160.013V19.3636H162.365V23.8125H162.467C162.664 23.2973 162.982 22.8939 163.422 22.6023C163.861 22.3068 164.412 22.1591 165.075 22.1591C165.681 22.1591 166.21 22.2917 166.661 22.5568C167.115 22.8182 167.467 23.1951 167.717 23.6875C167.971 24.1761 168.096 24.7614 168.092 25.4432V31H165.672V25.875C165.676 25.3371 165.539 24.9186 165.263 24.6193C164.99 24.3201 164.607 24.1705 164.115 24.1705C163.786 24.1705 163.494 24.2405 163.24 24.3807C162.99 24.5208 162.793 24.7254 162.649 24.9943C162.509 25.2595 162.437 25.5795 162.433 25.9545ZM179.297 27.2841V22.2727H181.717V31H179.393V29.4148H179.303C179.106 29.9261 178.778 30.3371 178.32 30.6477C177.865 30.9583 177.31 31.1136 176.655 31.1136C176.071 31.1136 175.558 30.9811 175.115 30.7159C174.672 30.4508 174.325 30.0739 174.075 29.5852C173.829 29.0966 173.704 28.5114 173.7 27.8295V22.2727H176.121V27.3977C176.125 27.9129 176.263 28.3201 176.536 28.6193C176.808 28.9186 177.174 29.0682 177.632 29.0682C177.924 29.0682 178.196 29.0019 178.45 28.8693C178.704 28.733 178.909 28.5322 179.064 28.267C179.223 28.0019 179.301 27.6742 179.297 27.2841ZM186.074 25.9545V31H183.653V22.2727H185.96V23.8125H186.062C186.256 23.3049 186.58 22.9034 187.034 22.608C187.489 22.3087 188.04 22.1591 188.688 22.1591C189.294 22.1591 189.822 22.2917 190.273 22.5568C190.723 22.822 191.074 23.2008 191.324 23.6932C191.574 24.1818 191.699 24.7652 191.699 25.4432V31H189.278V25.875C189.282 25.3409 189.146 24.9242 188.869 24.625C188.593 24.322 188.212 24.1705 187.727 24.1705C187.402 24.1705 187.114 24.2405 186.864 24.3807C186.617 24.5208 186.424 24.7254 186.284 24.9943C186.148 25.2595 186.078 25.5795 186.074 25.9545ZM196.027 19.3636V31H193.607V19.3636H196.027ZM197.966 31V22.2727H200.386V31H197.966ZM199.182 21.1477C198.822 21.1477 198.513 21.0284 198.256 20.7898C198.002 20.5473 197.875 20.2576 197.875 19.9205C197.875 19.5871 198.002 19.3011 198.256 19.0625C198.513 18.8201 198.822 18.6989 199.182 18.6989C199.542 18.6989 199.848 18.8201 200.102 19.0625C200.36 19.3011 200.489 19.5871 200.489 19.9205C200.489 20.2576 200.36 20.5473 200.102 20.7898C199.848 21.0284 199.542 21.1477 199.182 21.1477ZM202.325 31V22.2727H204.632V23.8125H204.734C204.916 23.3011 205.219 22.8977 205.643 22.6023C206.068 22.3068 206.575 22.1591 207.166 22.1591C207.765 22.1591 208.274 22.3087 208.695 22.608C209.115 22.9034 209.395 23.3049 209.536 23.8125H209.626C209.804 23.3125 210.126 22.9129 210.592 22.6136C211.062 22.3106 211.617 22.1591 212.257 22.1591C213.071 22.1591 213.732 22.4186 214.24 22.9375C214.751 23.4527 215.007 24.1837 215.007 25.1307V31H212.592V25.608C212.592 25.1231 212.464 24.7595 212.206 24.517C211.948 24.2746 211.626 24.1534 211.24 24.1534C210.801 24.1534 210.458 24.2936 210.212 24.5739C209.965 24.8504 209.842 25.2159 209.842 25.6705V31H207.496V25.5568C207.496 25.1288 207.373 24.7879 207.126 24.5341C206.884 24.2803 206.564 24.1534 206.166 24.1534C205.897 24.1534 205.655 24.2216 205.439 24.358C205.227 24.4905 205.058 24.678 204.933 24.9205C204.808 25.1591 204.746 25.4394 204.746 25.7614V31H202.325ZM216.919 31V22.2727H219.339V31H216.919ZM218.135 21.1477C217.775 21.1477 217.466 21.0284 217.209 20.7898C216.955 20.5473 216.828 20.2576 216.828 19.9205C216.828 19.5871 216.955 19.3011 217.209 19.0625C217.466 18.8201 217.775 18.6989 218.135 18.6989C218.495 18.6989 218.802 18.8201 219.055 19.0625C219.313 19.3011 219.442 19.5871 219.442 19.9205C219.442 20.2576 219.313 20.5473 219.055 20.7898C218.802 21.0284 218.495 21.1477 218.135 21.1477ZM225.92 22.2727V24.0909H220.665V22.2727H225.92ZM221.858 20.1818H224.278V28.3182C224.278 28.5417 224.313 28.7159 224.381 28.8409C224.449 28.9621 224.544 29.0473 224.665 29.0966C224.79 29.1458 224.934 29.1705 225.097 29.1705C225.21 29.1705 225.324 29.161 225.438 29.142C225.551 29.1193 225.638 29.1023 225.699 29.0909L226.08 30.892C225.958 30.9299 225.788 30.9735 225.568 31.0227C225.348 31.0758 225.081 31.108 224.767 31.1193C224.184 31.142 223.672 31.0644 223.233 30.8864C222.797 30.7083 222.458 30.4318 222.216 30.0568C221.973 29.6818 221.854 29.2083 221.858 28.6364V20.1818ZM231.381 31.1705C230.483 31.1705 229.71 30.9886 229.062 30.625C228.419 30.2576 227.922 29.7386 227.574 29.0682C227.225 28.3939 227.051 27.5966 227.051 26.6761C227.051 25.7784 227.225 24.9905 227.574 24.3125C227.922 23.6345 228.413 23.1061 229.045 22.7273C229.682 22.3485 230.428 22.1591 231.284 22.1591C231.86 22.1591 232.396 22.2519 232.892 22.4375C233.392 22.6193 233.828 22.8939 234.199 23.2614C234.574 23.6288 234.866 24.0909 235.074 24.6477C235.282 25.2008 235.386 25.8485 235.386 26.5909V27.2557H228.017V25.7557H233.108C233.108 25.4072 233.032 25.0985 232.881 24.8295C232.729 24.5606 232.519 24.3504 232.25 24.1989C231.985 24.0436 231.676 23.9659 231.324 23.9659C230.956 23.9659 230.631 24.0511 230.347 24.2216C230.066 24.3883 229.847 24.6136 229.688 24.8977C229.528 25.178 229.447 25.4905 229.443 25.8352V27.2614C229.443 27.6932 229.523 28.0663 229.682 28.3807C229.845 28.6951 230.074 28.9375 230.369 29.108C230.665 29.2784 231.015 29.3636 231.42 29.3636C231.689 29.3636 231.936 29.3258 232.159 29.25C232.383 29.1742 232.574 29.0606 232.733 28.9091C232.892 28.7576 233.013 28.572 233.097 28.3523L235.335 28.5C235.222 29.0379 234.989 29.5076 234.636 29.9091C234.288 30.3068 233.837 30.6174 233.284 30.8409C232.735 31.0606 232.1 31.1705 231.381 31.1705ZM240.182 31.142C239.519 31.142 238.919 30.9716 238.381 30.6307C237.847 30.286 237.422 29.7803 237.108 29.1136C236.797 28.4432 236.642 27.6212 236.642 26.6477C236.642 25.6477 236.803 24.8163 237.125 24.1534C237.447 23.4867 237.875 22.9886 238.409 22.6591C238.947 22.3258 239.536 22.1591 240.176 22.1591C240.665 22.1591 241.072 22.2424 241.398 22.4091C241.727 22.572 241.992 22.7765 242.193 23.0227C242.398 23.2652 242.553 23.5038 242.659 23.7386H242.733V19.3636H245.148V31H242.761V29.6023H242.659C242.545 29.8447 242.384 30.0852 242.176 30.3239C241.972 30.5587 241.705 30.7538 241.375 30.9091C241.049 31.0644 240.652 31.142 240.182 31.142ZM240.949 29.2159C241.339 29.2159 241.669 29.1098 241.938 28.8977C242.21 28.6818 242.419 28.3807 242.562 27.9943C242.71 27.608 242.784 27.1553 242.784 26.6364C242.784 26.1174 242.712 25.6667 242.568 25.2841C242.424 24.9015 242.216 24.6061 241.943 24.3977C241.67 24.1894 241.339 24.0852 240.949 24.0852C240.551 24.0852 240.216 24.1932 239.943 24.4091C239.67 24.625 239.464 24.9242 239.324 25.3068C239.184 25.6894 239.114 26.1326 239.114 26.6364C239.114 27.1439 239.184 27.5928 239.324 27.983C239.468 28.3693 239.674 28.6723 239.943 28.892C240.216 29.108 240.551 29.2159 240.949 29.2159Z"
                              fill="white"
                            />
                            <path
                              d="M24.1932 46C24.0838 45.6652 23.9396 45.3653 23.7607 45.1001C23.585 44.8317 23.3745 44.603 23.1293 44.4141C22.8873 44.2251 22.6122 44.081 22.304 43.9815C21.9957 43.8821 21.6577 43.8324 21.2898 43.8324C20.6866 43.8324 20.138 43.9882 19.6442 44.2997C19.1503 44.6113 18.7576 45.0703 18.4659 45.6768C18.1742 46.2834 18.0284 47.0275 18.0284 47.9091C18.0284 48.7907 18.1759 49.5348 18.4709 50.1413C18.7659 50.7479 19.1652 51.2069 19.669 51.5185C20.1728 51.83 20.7396 51.9858 21.3693 51.9858C21.9527 51.9858 22.4664 51.8615 22.9105 51.6129C23.358 51.361 23.706 51.0064 23.9545 50.549C24.2064 50.0883 24.3324 49.5464 24.3324 48.9233L24.7102 49.0028H21.6477V47.9091H25.5256V49.0028C25.5256 49.8414 25.3466 50.5705 24.9886 51.1903C24.634 51.8101 24.1435 52.2907 23.517 52.6321C22.8939 52.9702 22.178 53.1392 21.3693 53.1392C20.4678 53.1392 19.6757 52.9271 18.9929 52.5028C18.3134 52.0786 17.7831 51.4754 17.402 50.6932C17.0241 49.911 16.8352 48.983 16.8352 47.9091C16.8352 47.1037 16.9429 46.3795 17.1584 45.7365C17.3771 45.0902 17.6854 44.54 18.0831 44.0859C18.4808 43.6319 18.9515 43.2839 19.495 43.0419C20.0386 42.8 20.6368 42.679 21.2898 42.679C21.8267 42.679 22.3272 42.7602 22.7912 42.9226C23.2585 43.0817 23.6745 43.3087 24.0391 43.6037C24.407 43.8954 24.7135 44.245 24.9588 44.6527C25.2041 45.0571 25.3731 45.5062 25.4659 46H24.1932ZM30.5804 53.1591C29.891 53.1591 29.2862 52.995 28.7658 52.6669C28.2488 52.3388 27.8444 51.8797 27.5527 51.2898C27.2644 50.6998 27.1202 50.0104 27.1202 49.2216C27.1202 48.4261 27.2644 47.7318 27.5527 47.1385C27.8444 46.5452 28.2488 46.0845 28.7658 45.7564C29.2862 45.4283 29.891 45.2642 30.5804 45.2642C31.2698 45.2642 31.873 45.4283 32.3901 45.7564C32.9105 46.0845 33.3148 46.5452 33.6032 47.1385C33.8948 47.7318 34.0407 48.4261 34.0407 49.2216C34.0407 50.0104 33.8948 50.6998 33.6032 51.2898C33.3148 51.8797 32.9105 52.3388 32.3901 52.6669C31.873 52.995 31.2698 53.1591 30.5804 53.1591ZM30.5804 52.1051C31.1041 52.1051 31.535 51.9709 31.873 51.7024C32.2111 51.4339 32.4614 51.081 32.6238 50.6435C32.7862 50.206 32.8674 49.732 32.8674 49.2216C32.8674 48.7112 32.7862 48.2356 32.6238 47.7947C32.4614 47.3539 32.2111 46.9976 31.873 46.7259C31.535 46.4541 31.1041 46.3182 30.5804 46.3182C30.0568 46.3182 29.6259 46.4541 29.2878 46.7259C28.9498 46.9976 28.6995 47.3539 28.5371 47.7947C28.3747 48.2356 28.2935 48.7112 28.2935 49.2216C28.2935 49.732 28.3747 50.206 28.5371 50.6435C28.6995 51.081 28.9498 51.4339 29.2878 51.7024C29.6259 51.9709 30.0568 52.1051 30.5804 52.1051ZM39.7692 55.8636V45.3636H40.9027V46.5767H41.0419C41.1281 46.4441 41.2474 46.2751 41.3999 46.0696C41.5556 45.8608 41.7777 45.6752 42.0661 45.5128C42.3577 45.3471 42.7521 45.2642 43.2493 45.2642C43.8923 45.2642 44.459 45.425 44.9496 45.7464C45.4401 46.0679 45.8229 46.5237 46.098 47.1136C46.3731 47.7036 46.5107 48.3996 46.5107 49.2017C46.5107 50.0104 46.3731 50.7114 46.098 51.3047C45.8229 51.8946 45.4418 52.352 44.9545 52.6768C44.4673 52.9983 43.9055 53.1591 43.2692 53.1591C42.7786 53.1591 42.3859 53.0779 42.0909 52.9155C41.7959 52.7498 41.5689 52.5625 41.4098 52.3537C41.2507 52.1416 41.1281 51.9659 41.0419 51.8267H40.9425V55.8636H39.7692ZM40.9226 49.1818C40.9226 49.7585 41.0071 50.2673 41.1761 50.7081C41.3452 51.1456 41.5921 51.4886 41.9169 51.7372C42.2417 51.9825 42.6394 52.1051 43.1101 52.1051C43.6006 52.1051 44.0099 51.9759 44.3381 51.7173C44.6695 51.4555 44.9181 51.1042 45.0838 50.6634C45.2528 50.2192 45.3374 49.7254 45.3374 49.1818C45.3374 48.6449 45.2545 48.161 45.0888 47.7301C44.9264 47.2959 44.6795 46.9529 44.348 46.701C44.0199 46.4458 43.6072 46.3182 43.1101 46.3182C42.6328 46.3182 42.2318 46.4392 41.907 46.6811C41.5821 46.9197 41.3369 47.2545 41.1712 47.6854C41.0054 48.1129 40.9226 48.6117 40.9226 49.1818ZM48.3004 53V45.3636H49.4339V46.517H49.5135C49.6527 46.1392 49.9046 45.8326 50.2692 45.5973C50.6338 45.362 51.0447 45.2443 51.5021 45.2443C51.5883 45.2443 51.696 45.246 51.8253 45.2493C51.9545 45.2526 52.0523 45.2576 52.1186 45.2642V46.4574C52.0788 46.4474 51.9877 46.4325 51.8452 46.4126C51.706 46.3894 51.5585 46.3778 51.4027 46.3778C51.0315 46.3778 50.7 46.4557 50.4084 46.6115C50.12 46.764 49.8913 46.9761 49.7223 47.2479C49.5566 47.5163 49.4737 47.8229 49.4737 48.1676V53H48.3004ZM56.4787 53.1591C55.7429 53.1591 55.1082 52.9967 54.5746 52.6719C54.0443 52.3438 53.6349 51.8864 53.3466 51.2997C53.0616 50.7098 52.919 50.0237 52.919 49.2415C52.919 48.4593 53.0616 47.7699 53.3466 47.1733C53.6349 46.5734 54.036 46.1061 54.5497 45.7713C55.0668 45.4332 55.67 45.2642 56.3594 45.2642C56.7571 45.2642 57.1499 45.3305 57.5376 45.4631C57.9254 45.5956 58.2784 45.8111 58.5966 46.1094C58.9148 46.4044 59.1683 46.7955 59.3572 47.2827C59.5462 47.7699 59.6406 48.3698 59.6406 49.0824V49.5795H53.7543V48.5653H58.4474C58.4474 48.1345 58.3613 47.75 58.1889 47.4119C58.0199 47.0739 57.7779 46.8071 57.4631 46.6115C57.1515 46.416 56.7836 46.3182 56.3594 46.3182C55.892 46.3182 55.4877 46.4342 55.1463 46.6662C54.8082 46.8949 54.5481 47.1932 54.3658 47.5611C54.1835 47.929 54.0923 48.3234 54.0923 48.7443V49.4205C54.0923 49.9972 54.1918 50.486 54.3906 50.8871C54.5928 51.2848 54.8729 51.5881 55.2308 51.7969C55.5888 52.0024 56.0047 52.1051 56.4787 52.1051C56.7869 52.1051 57.0653 52.062 57.3139 51.9759C57.5658 51.8864 57.7829 51.7538 57.9652 51.5781C58.1475 51.3991 58.2884 51.1771 58.3878 50.9119L59.5213 51.2301C59.402 51.6146 59.2015 51.9527 58.9197 52.2443C58.638 52.5327 58.29 52.758 57.8757 52.9205C57.4614 53.0795 56.9957 53.1591 56.4787 53.1591ZM61.4254 53V45.3636H62.5589V46.5568H62.6584C62.8175 46.1491 63.0743 45.8326 63.429 45.6072C63.7836 45.3786 64.2095 45.2642 64.7067 45.2642C65.2105 45.2642 65.6297 45.3786 65.9645 45.6072C66.3026 45.8326 66.5661 46.1491 66.755 46.5568H66.8345C67.0301 46.1624 67.3234 45.8492 67.7145 45.6172C68.1056 45.3819 68.5746 45.2642 69.1214 45.2642C69.8042 45.2642 70.3627 45.478 70.7969 45.9055C71.2311 46.3298 71.4482 46.991 71.4482 47.8892V53H70.2749V47.8892C70.2749 47.3258 70.1207 46.9231 69.8125 46.6811C69.5043 46.4392 69.1413 46.3182 68.7237 46.3182C68.1868 46.3182 67.7708 46.4806 67.4759 46.8054C67.1809 47.1269 67.0334 47.5346 67.0334 48.0284V53H65.8402V47.7699C65.8402 47.3357 65.6993 46.986 65.4176 46.7209C65.1359 46.4524 64.773 46.3182 64.3288 46.3182C64.0239 46.3182 63.7389 46.3994 63.4737 46.5618C63.2119 46.7242 62.9998 46.9496 62.8374 47.2379C62.6783 47.523 62.5987 47.8527 62.5987 48.2273V53H61.4254ZM73.5934 53V45.3636H74.7667V53H73.5934ZM74.19 44.0909C73.9613 44.0909 73.7641 44.013 73.5984 43.8572C73.436 43.7015 73.3548 43.5142 73.3548 43.2955C73.3548 43.0767 73.436 42.8894 73.5984 42.7337C73.7641 42.5779 73.9613 42.5 74.19 42.5C74.4187 42.5 74.6142 42.5779 74.7766 42.7337C74.9424 42.8894 75.0252 43.0767 75.0252 43.2955C75.0252 43.5142 74.9424 43.7015 74.7766 43.8572C74.6142 44.013 74.4187 44.0909 74.19 44.0909ZM81.7282 49.8778V45.3636H82.9015V53H81.7282V51.7074H81.6486C81.4696 52.0952 81.1912 52.425 80.8134 52.6967C80.4355 52.9652 79.9583 53.0994 79.3816 53.0994C78.9043 53.0994 78.4801 52.995 78.1088 52.7862C77.7376 52.5741 77.446 52.2559 77.2338 51.8317C77.0217 51.4041 76.9157 50.8655 76.9157 50.2159V45.3636H78.089V50.1364C78.089 50.6932 78.2447 51.1373 78.5563 51.4688C78.8712 51.8002 79.2722 51.9659 79.7594 51.9659C80.0511 51.9659 80.3477 51.8913 80.6493 51.7422C80.9542 51.593 81.2095 51.3643 81.415 51.0561C81.6238 50.7479 81.7282 50.3551 81.7282 49.8778ZM85.0504 53V45.3636H86.1839V46.5568H86.2834C86.4425 46.1491 86.6993 45.8326 87.054 45.6072C87.4086 45.3786 87.8345 45.2642 88.3317 45.2642C88.8355 45.2642 89.2547 45.3786 89.5895 45.6072C89.9276 45.8326 90.1911 46.1491 90.38 46.5568H90.4595C90.6551 46.1624 90.9484 45.8492 91.3395 45.6172C91.7306 45.3819 92.1996 45.2642 92.7464 45.2642C93.4292 45.2642 93.9877 45.478 94.4219 45.9055C94.8561 46.3298 95.0732 46.991 95.0732 47.8892V53H93.8999V47.8892C93.8999 47.3258 93.7457 46.9231 93.4375 46.6811C93.1293 46.4392 92.7663 46.3182 92.3487 46.3182C91.8118 46.3182 91.3958 46.4806 91.1009 46.8054C90.8059 47.1269 90.6584 47.5346 90.6584 48.0284V53H89.4652V47.7699C89.4652 47.3357 89.3243 46.986 89.0426 46.7209C88.7609 46.4524 88.398 46.3182 87.9538 46.3182C87.6489 46.3182 87.3639 46.3994 87.0987 46.5618C86.8369 46.7242 86.6248 46.9496 86.4624 47.2379C86.3033 47.523 86.2237 47.8527 86.2237 48.2273V53H85.0504ZM107.609 53L106.843 52.2443L109.995 49.0923H101.832V47.9986H109.995L106.843 44.8565L107.609 44.0909L112.064 48.5455L107.609 53Z"
                              fill="white"
                            />
                          </g>
                          <defs>
                            <clipPath id="clip0_1295_6150">
                              <rect width="320" height="72" fill="white" />
                            </clipPath>
                          </defs>
                        </svg>
                      </div>
                    )}
                    <nav className="flex flex-1 flex-col">
                      {user && (
                        <div className="mb-3">
                          <h2 className="text-xl font-bold break-words">
                            Hi, {user.email}
                          </h2>
                        </div>
                      )}
                      <ul role="list" className="flex flex-1 flex-col gap-y-7">
                        <li>
                          <ul role="list" className="-mx-2 space-y-1">
                            <li key="">
                              <a
                                onClick={() => {
                                  setSidebarOpen(false);
                                  setTimeout(
                                    () => setFeedbackModalOpen(true),
                                    250
                                  );
                                }}
                                className={classNames(
                                  "text-gray-700 hover:text-brand-primary hover:bg-gray-50 cursor-pointer",
                                  "group flex gap-x-3 rounded-md p-2 text-sm leading-6 font-semibold "
                                )}
                              >
                                <div className="w-5/6">Contact Us</div>
                                <div className="w-1/5 flex justify-end">
                                  <ChevronRightIcon className="h-6 w-6 stroke-2 text-gray-400" />
                                </div>
                              </a>
                            </li>
                            <li key="">
                              <a
                                href={APP_STORE_URL}
                                target="_blank"
                                className={classNames(
                                  "text-gray-700 hover:text-brand-primary hover:bg-gray-50",
                                  "group flex gap-x-3 rounded-md p-2 text-sm leading-6 font-semibold "
                                )}
                              >
                                <div className="w-5/6">Download iOS</div>
                                <div className="w-1/5 flex justify-end">
                                  <ChevronRightIcon className="h-6 w-6 stroke-2 text-gray-400" />
                                </div>
                              </a>
                            </li>{" "}
                          </ul>
                        </li>
                        <li className="mt-auto">
                          {user ? (
                            <button
                              type="button"
                              onClick={async () => {
                                await signOut(auth);
                                setSidebarOpen(false);
                                toast.success("You have been signed out.");
                              }}
                              className="mt-2 flex items-center justify-center w-full bg-stone-200 text-black py-2 rounded-md font-semibold -mb-1"
                            >
                              Sign out
                            </button>
                          ) : (
                            <button
                              type="button"
                              onClick={() => {
                                setSidebarOpen(false);
                                setAuthActionType(AuthActionType.SignIn);
                                setAuthModalIsOpen(true);
                              }}
                              className="mt-2 flex items-center justify-center w-full bg-brand-primary text-white py-2 rounded-md font-semibold -mb-1"
                            >
                              Sign in
                            </button>
                          )}
                        </li>
                      </ul>
                    </nav>
                  </div>
                </Dialog.Panel>
              </Transition.Child>
            </div>
          </Dialog>
        </Transition.Root>

        <div className="fixed top-0 left-0 w-full h-12 bg-white z-50">
          {/* Top Nav Content */}
          <div className="mx-auto max-w-xl sticky top-0 z-40 flex h-12 shrink-0 items-center gap-x-4 px-4 sm:gap-x-6 flex">
            <button
              type="button"
              className="-m-2.5 p-2.5 text-gray-700"
              onClick={() => setSidebarOpen(true)}
            >
              <span className="sr-only">Open sidebar</span>
              <Bars3Icon className="h-6 w-6" aria-hidden="true" />
            </button>
            <Link to="/" className="cursor-pointer flex">
              <Logo />
              {isSubscribed && (
                <div className="bg-brand-primary text-white text-sm px-1.5 py-0.5 ml-2 rounded-md">
                  Premium
                </div>
              )}
            </Link>
            <div className="flex flex-row-reverse w-full">
              {auth.currentUser ? (
                <a
                  target="_blank"
                  href={APP_STORE_URL}
                  className="font-semibold text-brand-primary hidden sm:block"
                >
                  Download on iOS
                </a>
              ) : (
                <button
                  type="button"
                  onClick={() => setAuthModalIsOpen(true)}
                  className="font-semibold text-brand-primary"
                >
                  Sign in
                </button>
              )}
            </div>
          </div>
        </div>
      </div>
    </>
  );
};
